<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../_static/logo.svg><title>Indexing - TensorStore</title><link rel=stylesheet href=../_static/stylesheets/main.css><link rel=stylesheet href=../_static/stylesheets/palette.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>
          :root {
            --md-text-font-family: "Roboto";
            --md-code-font-family: "Roboto Mono";
          }
        </style></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=green data-md-color-accent=light-blue> <script>

  /* Prepend the base path to the given key to ensure uniqueness */
  function __prefix(key) {
    var prefix = new URL("..", location)
    return prefix.pathname + "." + key
  }

  /* Fetch the given key from the given storage */
  function __get(key, storage = localStorage) {
    return JSON.parse(storage.getItem(__prefix(key)))
  }
</script> <script>
  var palette = __get("__palette")
  if (palette !== null && typeof palette.color === "object")
    for (var key in palette.color)
      document.body.setAttribute("data-md-color-" + key, palette.color[key])
</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title=TensorStore class="md-header__button md-logo" aria-label=TensorStore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 132.0 132.0"><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=2.0 x2=130.8 y2=2.0 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=16.2 x2=130.8 y2=16.2 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=30.4 x2=130.8 y2=30.4 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=44.7 x2=130.8 y2=44.7 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=58.9 x2=130.8 y2=58.9 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=73.1 x2=130.8 y2=73.1 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=87.3 x2=130.8 y2=87.3 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=101.6 x2=130.8 y2=101.6 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=115.8 x2=130.8 y2=115.8 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=130.0 x2=130.8 y2=130.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=2.0 y2=130.0 x2=2.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=16.2 y2=130.0 x2=16.2 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=30.4 y2=130.0 x2=30.4 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=44.7 y2=130.0 x2=44.7 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=58.9 y2=130.0 x2=58.9 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=73.1 y2=130.0 x2=73.1 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=87.3 y2=130.0 x2=87.3 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=101.6 y2=130.0 x2=101.6 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=115.8 y2=130.0 x2=115.8 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=130.0 y2=130.0 x2=130.0 /><rect fill=currentColor x=3.5 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=17.7 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=46.2 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=17.7 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=117.3 width=11.2 height=11.2 /></svg> </a> <label class="md-header__button md-icon" for=__drawer> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-menu width=24 height=24 viewbox="0 0 24 24"><path d=M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z /></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> TensorStore </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Indexing </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=green data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-lightbulb width=24 height=24 viewbox="0 0 24 24"><path d="M12,2A7,7 0 0,0 5,9C5,11.38 6.19,13.47 8,14.74V17A1,1 0 0,0 9,18H15A1,1 0 0,0 16,17V14.74C17.81,13.47 19,11.38 19,9A7,7 0 0,0 12,2M9,21A1,1 0 0,0 10,22H14A1,1 0 0,0 15,21V20H9V21Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-lightbulb-outline width=24 height=24 viewbox="0 0 24 24"><path d="M12,2A7,7 0 0,1 19,9C19,11.38 17.81,13.47 16,14.74V17A1,1 0 0,1 15,18H9A1,1 0 0,1 8,17V14.74C6.19,13.47 5,11.38 5,9A7,7 0 0,1 12,2M9,21V20H15V21A1,1 0 0,1 14,22H10A1,1 0 0,1 9,21M12,4A5,5 0 0,0 7,9C7,11.05 8.23,12.81 10,13.58V16H14V13.58C15.77,12.81 17,11.05 17,9A5,5 0 0,0 12,4Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-magnify width=24 height=24 viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-magnify width=24 height=24 viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-left width=24 height=24 viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-close width=24 height=24 viewbox="0 0 24 24"><path d=M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z /></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/google/tensorstore/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> google/tensorstore </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title=TensorStore class="md-nav__button md-logo" aria-label=TensorStore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 132.0 132.0"><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=2.0 x2=130.8 y2=2.0 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=16.2 x2=130.8 y2=16.2 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=30.4 x2=130.8 y2=30.4 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=44.7 x2=130.8 y2=44.7 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=58.9 x2=130.8 y2=58.9 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=73.1 x2=130.8 y2=73.1 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=87.3 x2=130.8 y2=87.3 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=101.6 x2=130.8 y2=101.6 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=115.8 x2=130.8 y2=115.8 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=130.0 x2=130.8 y2=130.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=2.0 y2=130.0 x2=2.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=16.2 y2=130.0 x2=16.2 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=30.4 y2=130.0 x2=30.4 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=44.7 y2=130.0 x2=44.7 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=58.9 y2=130.0 x2=58.9 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=73.1 y2=130.0 x2=73.1 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=87.3 y2=130.0 x2=87.3 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=101.6 y2=130.0 x2=101.6 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=115.8 y2=130.0 x2=115.8 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=130.0 y2=130.0 x2=130.0 /><rect fill=currentColor x=3.5 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=17.7 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=46.2 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=17.7 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=117.3 width=11.2 height=11.2 /></svg> </a> TensorStore </label> <div class=md-nav__source> <a href=https://github.com/google/tensorstore/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> google/tensorstore </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1> <a class href=tutorial.html>Python API</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Python API" data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Python API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=tutorial.html class=md-nav__link> Tutorial </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Indexing <span class="md-nav__icon md-icon"></span> </label> <a href class="md-nav__link md-nav__link--active"> Indexing </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Indexing </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#index-transforms class=md-nav__link> Index transforms </a> <nav class=md-nav aria-label="Index transforms"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#numpy-style-indexing class=md-nav__link> NumPy-style indexing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integer-indexing class=md-nav__link> Integer indexing </a> </li> <li class=md-nav__item> <a href=#interval-indexing class=md-nav__link> Interval indexing </a> </li> <li class=md-nav__item> <a href=#adding-singleton-dimensions class=md-nav__link> Adding singleton dimensions </a> </li> <li class=md-nav__item> <a href=#ellipsis class=md-nav__link> Ellipsis </a> </li> <li class=md-nav__item> <a href=#integer-array-indexing class=md-nav__link> Integer array indexing </a> </li> <li class=md-nav__item> <a href=#boolean-array-indexing class=md-nav__link> Boolean array indexing </a> </li> <li class=md-nav__item> <a href=#differences-compared-to-numpy-indexing class=md-nav__link> Differences compared to NumPy indexing </a> </li> <li class=md-nav__item> <a href=#vectorized-indexing-mode-vindex class=md-nav__link> Vectorized indexing mode (vindex) </a> </li> <li class=md-nav__item> <a href=#outer-indexing-mode-oindex class=md-nav__link> Outer indexing mode (oindex) </a> <nav class=md-nav aria-label="Outer indexing mode (oindex)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dimension-expressions class=md-nav__link> Dimension expressions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dimension-selections class=md-nav__link> Dimension selections </a> </li> <li class=md-nav__item> <a href=#dimension-expression-construction class=md-nav__link> Dimension expression construction </a> </li> <li class=md-nav__item> <a href=#numpy-style-dimension-expression-indexing class=md-nav__link> NumPy-style dimension expression indexing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=api/index.html class=md-nav__link> API reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 data-md-state=indeterminate type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> <a class href=../installation.html>Setup</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Setup data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation.html class=md-nav__link> Building and Installing </a> </li> <li class=md-nav__item> <a href=../environment.html class=md-nav__link> Environment variables </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 data-md-state=indeterminate type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> <a class href=../spec.html>JSON</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=JSON data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> JSON </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../spec.html class=md-nav__link> JSON Spec </a> </li> <li class=md-nav__item> <a href=../index_space.html class=md-nav__link> Index space </a> </li> <li class=md-nav__item> <a href=../schema.html class=md-nav__link> Schema </a> </li> <li class=md-nav__item> <a href=../context.html class=md-nav__link> Context framework </a> </li> <li class=md-nav__item> <a href=../driver/index.html class=md-nav__link> Drivers </a> </li> <li class=md-nav__item> <a href=../kvstore/index.html class=md-nav__link> Key-Value Storage Layer </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Indexing </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#index-transforms class=md-nav__link> Index transforms </a> <nav class=md-nav aria-label="Index transforms"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#numpy-style-indexing class=md-nav__link> NumPy-style indexing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integer-indexing class=md-nav__link> Integer indexing </a> </li> <li class=md-nav__item> <a href=#interval-indexing class=md-nav__link> Interval indexing </a> </li> <li class=md-nav__item> <a href=#adding-singleton-dimensions class=md-nav__link> Adding singleton dimensions </a> </li> <li class=md-nav__item> <a href=#ellipsis class=md-nav__link> Ellipsis </a> </li> <li class=md-nav__item> <a href=#integer-array-indexing class=md-nav__link> Integer array indexing </a> </li> <li class=md-nav__item> <a href=#boolean-array-indexing class=md-nav__link> Boolean array indexing </a> </li> <li class=md-nav__item> <a href=#differences-compared-to-numpy-indexing class=md-nav__link> Differences compared to NumPy indexing </a> </li> <li class=md-nav__item> <a href=#vectorized-indexing-mode-vindex class=md-nav__link> Vectorized indexing mode (vindex) </a> </li> <li class=md-nav__item> <a href=#outer-indexing-mode-oindex class=md-nav__link> Outer indexing mode (oindex) </a> <nav class=md-nav aria-label="Outer indexing mode (oindex)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dimension-expressions class=md-nav__link> Dimension expressions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dimension-selections class=md-nav__link> Dimension selections </a> </li> <li class=md-nav__item> <a href=#dimension-expression-construction class=md-nav__link> Dimension expression construction </a> </li> <li class=md-nav__item> <a href=#numpy-style-dimension-expression-indexing class=md-nav__link> NumPy-style dimension expression indexing </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset" role=main> <h1 id=indexing><span id=python-indexing></span>Indexing<a class=headerlink href=#indexing title="Permalink to this headline">¶</a></h1> <p><a class="reference internal" href=api/tensorstore.TensorStore.html title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.TensorStore</span></code></a> (and objects of other <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> types) support a common set of <em>indexing operations</em> for read/write access to individual positions and subsets of positions. In addition to full support for <a class="reference internal" href=#python-numpy-style-indexing><span class="std std-ref">NumPy-style basic and advanced indexing</span></a>, <a class="reference internal" href=#python-dim-expressions><span class="std std-ref">dimension expressions</span></a> provide additional indexing capabilities integrated with TensorStore’s support for <a class="reference internal" href=../index_space.html#dimension-labels><span class="std std-ref">labeled/named dimensions</span></a> and non-zero origins.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>In TensorStore, all indexing operations result in a (read/write) <em>view</em> of the original object, represented as a new object of the same type with a different <a class="reference internal" href=api/tensorstore.IndexDomain.html title="tensorstore.IndexDomain (Python class) — Domain (including bounds and optional dimension labels) of an N-dimensional index space."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.IndexDomain</span></code></a>. Indexing operations never implicitly perform I/O or copy data. This differs from <a class="reference external" href=https://numpy.org/doc/stable/user/basics.indexing.html#module-numpy.doc.indexing title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>NumPy</span> <span class=pre>indexing</span></code></a>, where basic indexing results in a view of the original data, but advanced indexing always results in a copy.</p> </div> <h2 id=index-transforms>Index transforms<a class=headerlink href=#index-transforms title="Permalink to this headline">¶</a></h2> <p>Indexing operations are composed into a normalized representation via the <a class="reference internal" href=api/tensorstore.IndexTransform.html title="tensorstore.IndexTransform (Python class) — Represents a transform from an input index space to an output space."><code class="xref py py-obj docutils literal notranslate"><span class=pre>tensorstore.IndexTransform</span></code></a> class, which represents an <a class="reference internal" href=../index_space.html#index-transform><span class="std std-ref">index transform</span></a> from an input space to an output space. The examples below may include the <a class="reference internal" href=../index_space.html#index-transform><span class="std std-ref">index transform</span></a> representation.</p> <h3 id=numpy-style-indexing><span id=python-numpy-style-indexing></span>NumPy-style indexing<a class=headerlink href=#numpy-style-indexing title="Permalink to this headline">¶</a></h3> <p>NumPy-style indexing is performed using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> is any <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object and the indexing expression <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> is one of:</p> <table class="colwidths-auto docutils data align-default"> <tbody> <tr class=row-odd><td><p>an integer;</p></td> <td><p><a class="reference internal" href=#python-indexing-integer><span class="std std-ref">Integer indexing</span></a></p></td> </tr> <tr class=row-even><td><p>a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> object <code class="code highlight python docutils literal highlight-python"><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>:</span><span class=n>step</span></code>, e.g. <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[:]</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span></code>, where the <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, or <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> values are each <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>, integers or sequences of integer or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> values;</p></td> <td><p><a class="reference internal" href=#python-indexing-interval><span class="std std-ref">Interval indexing</span></a></p></td> </tr> <tr class=row-odd><td><p><a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref py py-obj docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>None</span></code></a>;</p></td> <td><p><a class="reference internal" href=#python-indexing-newaxis><span class="std std-ref">Adding singleton dimensions</span></a></p></td> </tr> <tr class=row-even><td><p><code class="code highlight python docutils literal highlight-python"><span class=o>...</span></code> or <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>;</p></td> <td><p><a class="reference internal" href=#python-indexing-ellipsis><span class="std std-ref">Ellipsis</span></a></p></td> </tr> <tr class=row-odd><td><p><a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>array_like</span></code></a> with integer data type;</p></td> <td><p><a class="reference internal" href=#python-indexing-integer-array><span class="std std-ref">Integer array indexing</span></a></p></td> </tr> <tr class=row-even><td><p><a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>array_like</span></code></a> with <a class="reference internal" href=api/tensorstore.bool.html title="tensorstore.bool (Python data) — Boolean data type (0 or 1).  Corresponds to the python:bool type and numpy.bool_."><code class="xref any py py-data docutils literal notranslate"><span class=pre>bool</span></code></a> data type;</p></td> <td><p><a class="reference internal" href=#python-indexing-boolean-array><span class="std std-ref">Boolean array indexing</span></a></p></td> </tr> <tr class=row-odd><td><p><a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>tuple</span></code></a> of any of the above, e.g. <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>:,</span> <span class=mi>3</span><span class=p>]</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=o>...</span><span class=p>,</span> <span class=p>:,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]</span></code>.</p></td> <td></td> </tr> </tbody> </table> <p>This form of indexing always operates on a prefix of the dimensions, consuming dimensions from the existing domain and adding dimensions to the resultant domain in order; if the indexing expression consumes fewer than <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=o>.</span><span class=n>rank</span></code> dimensions, the remaining dimensions are retained unchanged as if indexed by <code class="code highlight python docutils literal highlight-python"><span class=p>:</span></code>.</p> <h2 id=integer-indexing><span id=python-indexing-integer></span>Integer indexing<a class=headerlink href=#integer-indexing title="Permalink to this headline">¶</a></h2> <p>Indexing with an integer selects a single position within the corresponding dimension:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [3, 4, 5],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: 5,</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_rank&#39;: 0},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>Each integer index consumes a single dimension from the original domain and adds no dimensions to the result domain.</p> <p>Because TensorStore supports index domains defined over negative indices, negative values have no special meaning; they simply refer to negative positions:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=k>await</span> <span class=n>ts</span><span class=o>.</span><span class=n>open</span><span class=p>({</span>
<span class=gp>... </span>    <span class=s2>&quot;dtype&quot;</span><span class=p>:</span> <span class=s2>&quot;int32&quot;</span><span class=p>,</span>
<span class=gp>... </span>    <span class=s2>&quot;driver&quot;</span><span class=p>:</span> <span class=s2>&quot;array&quot;</span><span class=p>,</span>
<span class=gp>... </span>    <span class=s2>&quot;array&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
<span class=gp>... </span>    <span class=s2>&quot;transform&quot;</span><span class=p>:</span> <span class=p>{</span>
<span class=gp>... </span>        <span class=s2>&quot;input_shape&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>],</span>
<span class=gp>... </span>        <span class=s2>&quot;input_inclusive_min&quot;</span><span class=p>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>10</span><span class=p>],</span>
<span class=gp>... </span>        <span class=s2>&quot;output&quot;</span><span class=p>:</span> <span class=p>[{</span>
<span class=gp>... </span>            <span class=s2>&quot;input_dimension&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
<span class=gp>... </span>            <span class=s2>&quot;offset&quot;</span><span class=p>:</span> <span class=mi>10</span>
<span class=gp>... </span>        <span class=p>}],</span>
<span class=gp>... </span>    <span class=p>},</span>
<span class=gp>... </span><span class=p>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>10</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: 1,</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_rank&#39;: 0},</span>
<span class=go>})</span>
</code></pre></div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This differs from the behavior of the built-in sequence types and <a class="reference external" href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>numpy.ndarray</span></code></a>, where a negative index specifies a position relative to the end (upper bound).</p> </div> <p>Specifying an index outside the explicit bounds of a dimension results in an immediate error:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
<span class=gt>Traceback (most recent call last):</span>
    <span class=o>...</span>
<span class=gr>IndexError</span>: <span class=n>Checking bounds of constant output index map for dimension 0: Index 4 is outside valid range [0, 4)</span>
</code></pre></div> </div> <p>Specifying an index outside the <a class="reference internal" href=../index_space.html#implicit-bounds><span class="std std-ref">implicit bounds</span></a> of a dimension is permitted:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>y</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_shape</span><span class=o>=</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>implicit_lower_bounds</span><span class=o>=</span><span class=p>[</span><span class=kc>True</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
<span class=go>Rank 0 -&gt; 1 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = -1</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
<span class=gt>Traceback (most recent call last):</span>
    <span class=o>...</span>
<span class=gr>IndexError</span>: <span class=n>Checking bounds of constant output index map for dimension 0: Index 4 is outside valid range (-inf, 4)</span>
</code></pre></div> </div> <p>While implicit bounds do not constrain indexing operations, the bounds will still be checked by any subsequent read or write operation, which will fail if any index is actually out of bounds.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>In addition to the <a class="reference external" href=https://docs.python.org/3/library/functions.html#int title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>int</span></code></a> type, integer indices may be specified using any object that supports the <code class="code highlight python docutils literal highlight-python"><span class=fm>__index__</span></code> protocol (<span class=target id=index-0></span><a class="pep reference external" href=https://www.python.org/dev/peps/pep-0357><strong>PEP 357</strong></a>), including <a class="reference external" href=https://numpy.org/doc/stable/reference/arrays.scalars.html#arrays-scalars title="(in NumPy v1.19)"><span class="xref std std-ref">NumPy integer scalar types</span></a>.</p> </div> <h2 id=interval-indexing><span id=python-indexing-interval></span>Interval indexing<a class=headerlink href=#interval-indexing title="Permalink to this headline">¶</a></h2> <p>Indexing with a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> object <code class="code highlight python docutils literal highlight-python"><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>:</span><span class=n>step</span></code> selects an interval or strided interval within the corresponding dimension:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [1, 2, 3, 4],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [5],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [1],</span>
<span class=go>    &#39;output&#39;: [{&#39;input_dimension&#39;: 0, &#39;offset&#39;: -1}],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>As for the built-in sequence types, the <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> value is inclusive while the <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code> value is exclusive.</p> <p>Each of <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, and <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> may be an integer, <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>, or omitted (equivalent to specifying <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>). Specifying <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> for <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code> retains the existing lower or upper bound, respectively, for the dimension. Specifying <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> for <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> is equivalent to specifying <code class="code highlight python docutils literal highlight-python"><span class=mi>1</span></code>.</p> <p>When the <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> is <code class="code highlight python docutils literal highlight-python"><span class=mi>1</span></code>, the domain of the resulting sliced dimension is <em>not</em> translated to have an origin of zero; instead, it has an origin equal to the start position of the interval (or the existing origin of the start position is unspecified):</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: 2,</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_rank&#39;: 0},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>If the <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> is not <code class="code highlight python docutils literal highlight-python"><span class=mi>1</span></code>, the origin of the resulting sliced dimension is equal to the <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> position divided by the <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> value, rounded towards zero:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [3, 5, 7],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [4],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [1],</span>
<span class=go>    &#39;output&#39;: [{&#39;input_dimension&#39;: 0, &#39;offset&#39;: -1}],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>7</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [7, 5],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [-1],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [-3],</span>
<span class=go>    &#39;output&#39;: [{&#39;input_dimension&#39;: 0, &#39;offset&#39;: 3}],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>It is an error to specify an interval outside the explicit bounds of a dimension:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>12</span><span class=p>]</span>
<span class=gt>Traceback (most recent call last):</span>
    <span class=o>...</span>
<span class=gr>IndexError</span>: <span class=n>Computing interval slice for dimension 0: Slice interval [3, 12) is not contained within domain [0, 10)</span>
</code></pre></div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This behavior differs from that of the built-in sequence types and <a class="reference external" href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>numpy.ndarray</span></code></a>, where any out-of-bounds indices within the interval are silently skipped.</p> </div> <p>Specifying an interval outside the <a class="reference internal" href=../index_space.html#implicit-bounds><span class="std std-ref">implicit bounds</span></a> of a dimension is permitted:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>y</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_shape</span><span class=o>=</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>implicit_lower_bounds</span><span class=o>=</span><span class=p>[</span><span class=kc>True</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
<span class=go>Rank 1 -&gt; 1 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [-1, 2)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
</code></pre></div> </div> <p>If a non-<a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> value is specified for <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, the lower or upper bound, respectively, of the resultant dimension will be marked explicit. If <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> is specified for <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, the lower or upper bound, respectively, of the resultant dimension will be marked explicit if the corresponding original bound is marked explicit.</p> <p>As with integer indexing, negative <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code> or <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code> values have no special meaning, and simply indicate negative positions.</p> <p>Any of the <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, or <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code> values may be specified as a sequence of integer or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> values (e.g. a <a class="reference internal" href=api/tensorstore.KvStore.list.html title="tensorstore.KvStore.list (Python method) — Lists the keys in the key-value store."><code class="xref any py py-meth docutils literal notranslate"><span class=pre>list</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>tuple</span></code></a> or 1-d <a class="reference external" href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>numpy.ndarray</span></code></a>), rather than a single integer:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>]],</span>
<span class=gp>... </span>             <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>):(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[6, 7, 8], [10, 11, 12]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [3, 4],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [1, 1],</span>
<span class=go>    &#39;output&#39;: [</span>
<span class=go>      {&#39;input_dimension&#39;: 0, &#39;offset&#39;: -1},</span>
<span class=go>      {&#39;input_dimension&#39;: 1, &#39;offset&#39;: -1},</span>
<span class=go>    ],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>This is equivalent to specifying a sequence of <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> objects:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>]],</span>
<span class=gp>... </span>             <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[6, 7, 8], [10, 11, 12]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [3, 4],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [1, 1],</span>
<span class=go>    &#39;output&#39;: [</span>
<span class=go>      {&#39;input_dimension&#39;: 0, &#39;offset&#39;: -1},</span>
<span class=go>      {&#39;input_dimension&#39;: 1, &#39;offset&#39;: -1},</span>
<span class=go>    ],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>It is an error to specify a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>slice</span></code></a> with sequences of unequal lengths, but a sequence may be combined with a scalar value:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>]],</span>
<span class=gp>... </span>             <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>:(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[6, 7, 8], [10, 11, 12]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [3, 4],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [1, 1],</span>
<span class=go>    &#39;output&#39;: [</span>
<span class=go>      {&#39;input_dimension&#39;: 0, &#39;offset&#39;: -1},</span>
<span class=go>      {&#39;input_dimension&#39;: 1, &#39;offset&#39;: -1},</span>
<span class=go>    ],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <h2 id=adding-singleton-dimensions><span id=python-indexing-newaxis></span>Adding singleton dimensions<a class=headerlink href=#adding-singleton-dimensions title="Permalink to this headline">¶</a></h2> <p>Specifying a value of <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref py py-obj docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> (equal to <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>) adds a new dummy/singleton dimension with <a class="reference internal" href=../index_space.html#implicit-bounds><span class="std std-ref">implicit bounds</span></a> <span class="math notranslate nohighlight">\([0, 1)\)</span>:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0*, 1*)</span>
<span class=go>    1: (-inf*, +inf*)</span>
<span class=go>    2: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[1]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
</code></pre></div> </div> <p>This indexing term consumes no dimensions from the original domain and adds a single dimension after any dimensions added by prior indexing operations:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span> <span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
<span class=go>Rank 4 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*)</span>
<span class=go>    1: [0*, 1*)</span>
<span class=go>    2: [0*, 1*)</span>
<span class=go>    3: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[3]</span>
</code></pre></div> </div> <p>Because the added dimension has implicit bounds, it may be given arbitrary bounds by a subsequent interval indexing term:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>][</span><span class=mi>3</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [3, 10)</span>
<span class=go>    1: (-inf*, +inf*)</span>
<span class=go>    2: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[1]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
</code></pre></div> </div> <h2 id=ellipsis><span id=python-indexing-ellipsis></span>Ellipsis<a class=headerlink href=#ellipsis title="Permalink to this headline">¶</a></h2> <p>Specifying the special <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a> value (<code class="code highlight python docutils literal highlight-python"><span class=o>...</span></code>) is equivalent to specifying as many full slices <code class="code highlight python docutils literal highlight-python"><span class=p>:</span></code> as needed to consume the remaining dimensions of the original domin not consumed by other indexing terms:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [2, 5],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [1, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0],</span>
<span class=go>    &#39;output&#39;: [{&#39;input_dimension&#39;: 1}],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>At most one <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a> may be specified within a single NumPy-style indexing expression:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span>
<span class=gt>Traceback (most recent call last):</span>
    <span class=o>...</span>
<span class=gr>IndexError</span>: <span class=n>An index can only have a single ellipsis (`...`)</span>
</code></pre></div> </div> <p>As a complete indexing expression , <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a> has no effect and is equivalent to the empty tuple <code class="code highlight python docutils literal highlight-python"><span class=p>()</span></code>, but can still be useful for the purpose of an assignment:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=mi>7</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [7, 7, 7, 7],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [4], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <h2 id=integer-array-indexing><span id=python-indexing-integer-array></span>Integer array indexing<a class=headerlink href=#integer-array-indexing title="Permalink to this headline">¶</a></h2> <p>Specifying an <a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>array_like</span></code></a> <em>index array</em> of integer values selects the coordinates of the dimension given by the elements of the array:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [5, 2, 2],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[5, 4], [3, 2]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>This indexing term consumes a single dimension from the original domain, and when the full indexing expression involves just a single array indexing term, adds the dimensions of the index array to the result domain.</p> <p>As with integer and interval indexing, and unlike NumPy, negative values in an index array have no special meaning, and simply indicate negative positions.</p> <p>When a single indexing expression includes multiple index arrays, <em>vectorized</em> array indexing semantics apply by default: the shapes of the index arrays must all be broadcast-compatible, and the dimensions of the single broadcasted domain are added to the result domain:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [1, 4, 5],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[1, 4], [6, 5]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[1, 4], [5, 6]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>If all of the index arrays are applied to consecutive dimensions without any interleaved <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> terms (interleaved integer index terms are permitted), then by default <em>legacy NumPy</em> semantics are used: the dimensions of the broadcasted array domain are added <em>inline</em> to the result domain after any dimensions added by prior indexing terms in the indexing expression:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[4, 2], [8, 6]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>If there are any interleaved <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> terms, then instead the dimensions of the broadcasted array domain are added as the first dimensions of the result domain:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[4, 8], [2, 6]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 2, [1]],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0, [0]],</span>
<span class=go>    &#39;output&#39;: [{&#39;input_dimension&#39;: 0}, {&#39;input_dimension&#39;: 1}],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>To ensure that the added array domain dimensions are added as the first dimensions of the result domain regardless of whether there are any interleaved <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> terms, use the <a class="reference internal" href=#python-vindex-indexing><span class="std std-ref">vindex indexing method</span></a>.</p> <p>To instead perform <em>outer</em> array indexing, where each index array is applied orthogonally, use the <a class="reference internal" href=#python-oindex-indexing><span class="std std-ref">oindex indexing method</span></a>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The <em>legacy NumPy</em> indexing behavior, whereby array domain dimensions are added either <em>inline</em> or as the first dimensions depending on whether the index arrays are applied to consecutive dimensions, is the default behavior for compatibility with NumPy but may be confusing. It is recommended to instead use either the <a class="reference internal" href=#python-vindex-indexing><span class="std std-ref">vindex</span></a> or <a class="reference internal" href=#python-oindex-indexing><span class="std std-ref">oindex</span></a> indexing method for less confusing behavior when using multiple index arrays.</p> </div> <h2 id=boolean-array-indexing><span id=python-indexing-boolean-array></span>Boolean array indexing<a class=headerlink href=#boolean-array-indexing title="Permalink to this headline">¶</a></h2> <p>Specifying an <a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>array_like</span></code></a> of <a class="reference internal" href=api/tensorstore.bool.html title="tensorstore.bool (Python data) — Boolean data type (0 or 1).  Corresponds to the python:bool type and numpy.bool_."><code class="xref any py py-data docutils literal notranslate"><span class=pre>bool</span></code></a> values is equivalent to specifying a sequence of integer index arrays containing the coordinates of <a class="reference external" href=https://docs.python.org/3/library/constants.html#True title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>True</span></code></a> values (in C order), e.g. as obtained from <a class="reference external" href=https://numpy.org/doc/stable/reference/generated/numpy.nonzero.html#numpy.nonzero title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>numpy.nonzero</span></code></a>.</p> <p>Specifying a 1-d <a class="reference internal" href=api/tensorstore.bool.html title="tensorstore.bool (Python data) — Boolean data type (0 or 1).  Corresponds to the python:bool type and numpy.bool_."><code class="xref any py py-data docutils literal notranslate"><span class=pre>bool</span></code></a> array is equivalent to a single index array of the non-zero coordinates:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [0, 2, 3],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># equivalent, using index array</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [0, 2, 3],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>More generally, specifying an <code class="docutils literal notranslate"><span class=pre>n</span></code>-dimensional <a class="reference internal" href=api/tensorstore.bool.html title="tensorstore.bool (Python data) — Boolean data type (0 or 1).  Corresponds to the python:bool type and numpy.bool_."><code class="xref any py py-data docutils literal notranslate"><span class=pre>bool</span></code></a> array is equivalent to specifying <code class="docutils literal notranslate"><span class=pre>n</span></code> index arrays, where the <code class="docutils literal notranslate"><span class=pre>i</span></code>th index array specifies the <code class="docutils literal notranslate"><span class=pre>i</span></code>th coordinate of the <a class="reference external" href=https://docs.python.org/3/library/constants.html#True title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>True</span></code></a> values:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=kc>False</span><span class=p>],</span> <span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>]]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [0, 3, 4],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># equivalent, using index arrays</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [0, 3, 4],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>This indexing term consumes <code class="docutils literal notranslate"><span class=pre>n</span></code> dimensions from the original domain, where <code class="docutils literal notranslate"><span class=pre>n</span></code> is the rank of the <a class="reference internal" href=api/tensorstore.bool.html title="tensorstore.bool (Python data) — Boolean data type (0 or 1).  Corresponds to the python:bool type and numpy.bool_."><code class="xref any py py-data docutils literal notranslate"><span class=pre>bool</span></code></a> array.</p> <p>It is perfectly valid to mix boolean array indexing with other forms of indexing, including integer array indexing, with exactly the same result as if the boolean array were replaced by the equivalent sequence of integer index arrays:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [2, 8],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># equivalent, using index array</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [2, 8],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2], &#39;input_inclusive_min&#39;: [0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Mixing boolean and integer index arrays in the default vectorized indexing mode, while supported for compatibility with NumPy, is likely to be confusing. In most cases of mixed boolean and integer array indexing, <a class="reference internal" href=#python-oindex-indexing><span class="std std-ref">outer indexing mode</span></a> provides more useful behavior.</p> </div> <p>The scalar values <a class="reference external" href=https://docs.python.org/3/library/constants.html#True title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>True</span></code></a> and <a class="reference external" href=https://docs.python.org/3/library/constants.html#False title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>False</span></code></a> are treated as zero-rank boolean arrays. Zero-rank boolean arrays are supported, but there is no equivalent integer index array representation. If there are no other integer or boolean arrays, specifying a zero-rank boolean array is equivalent to specifying <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a>, except that the added dimension has explicit rather than implicit bounds, and in the case of a <a class="reference external" href=https://docs.python.org/3/library/constants.html#False title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>False</span></code></a> array the added dimension has the empty bounds of <span class="math notranslate nohighlight">\([0, 0)\)</span>:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=kc>True</span><span class=p>]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*)</span>
<span class=go>    1: [0, 1)</span>
<span class=go>    2: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=kc>False</span><span class=p>]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*)</span>
<span class=go>    1: [0, 0)</span>
<span class=go>    2: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
</code></pre></div> </div> <p>If there are other integer or boolean arrays, specifying a zero-rank boolean array has no effect except that:</p> <ol class="arabic simple"> <li><p>the other index array shapes must be broadcast-compatible with the shape <code class="code highlight python docutils literal highlight-python"><span class=p>[</span><span class=mi>0</span><span class=p>]</span></code> in the case of a <a class="reference external" href=https://docs.python.org/3/library/constants.html#False title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>False</span></code></a> zero-rank array, meaning they are all empty arrays (in the case of a <a class="reference external" href=https://docs.python.org/3/library/constants.html#True title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>True</span></code></a> zero-rank array, the other index array shapes must be broadcast-compatible with the shape <code class="code highlight python docutils literal highlight-python"><span class=p>[</span><span class=mi>1</span><span class=p>]</span></code>, which is always satisfied);</p></li> <li><p>in legacy NumPy indexing mode, if it is separated from another integer or boolean array term by a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a>, it causes the dimensions of the broadcast array domain to be added as the first dimensions of the result domain:</p></li> </ol> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Index array dimension added to result domain inline</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=kc>True</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*)</span>
<span class=go>    1: [0, 2)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * bounded((-inf, +inf), array(in)), where array =</span>
<span class=go>      {{0, 1}}</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[:,</span> <span class=kc>False</span><span class=p>,</span> <span class=p>[]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*)</span>
<span class=go>    1: [0, 0)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Index array dimensions added as first dimension of result domain</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=p>:,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0, 2)</span>
<span class=go>    1: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[1]</span>
<span class=go>    out[1] = 0 + 1 * bounded((-inf, +inf), array(in)), where array =</span>
<span class=go>      {{0}, {1}}</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=kc>False</span><span class=p>,</span> <span class=p>:,</span> <span class=p>[]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0, 0)</span>
<span class=go>    1: (-inf*, +inf*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[1]</span>
<span class=go>    out[1] = 0</span>
</code></pre></div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Zero-rank boolean arrays are supported for consistency and for compatibility with NumPy, but are rarely useful.</p> </div> <h2 id=differences-compared-to-numpy-indexing><span id=python-indexing-numpy-comparison></span>Differences compared to NumPy indexing<a class=headerlink href=#differences-compared-to-numpy-indexing title="Permalink to this headline">¶</a></h2> <p>TensorStore indexing has near-perfect compatibility with NumPy, but there are a few differences to be aware of:</p> <ul class=simple> <li><p>Negative indices have no special meaning in TensorStore, and simply refer to negative positions. TensorStore does not support an equivalent shortcut syntax to specify a position <code class="docutils literal notranslate"><span class=pre>n</span></code> relative to the upper bound of a dimension; instead, it must be specified explicitly, e.g. <code class="code highlight python docutils literal highlight-python"><span class=n>x</span><span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>domain</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>exclusive_max</span> <span class=o>-</span> <span class=n>n</span><span class=p>]</span></code>.</p></li> <li><p>In TensorStore, out-of-bounds intervals specified by a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> result in an error. In NumPy, out-of-bounds indices specified by a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> are silently truncated.</p></li> <li><p>To specify a sequence of indexing terms when using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code> in TensorStore, <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> must be a <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>tuple</span></code></a>. In NumPy, for compatibility with its predecessor library <em>Numeric</em>, if <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> is a <a class="reference internal" href=api/tensorstore.KvStore.list.html title="tensorstore.KvStore.list (Python method) — Lists the keys in the key-value store."><code class="xref any py py-meth docutils literal notranslate"><span class=pre>list</span></code></a> or other non-<a class="reference external" href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>numpy.ndarray</span></code></a> sequence type containing at least one <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> value, it is interpreted the same as a <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>tuple</span></code></a> <a class="reference external" href=https://numpy.org/doc/stable/reference/arrays.indexing.html#arrays-indexing title="(in NumPy v1.19)"><span class="xref std std-ref">(this behavior is deprecated in NumPy since version 1.15.0)</span></a>. TensorStore, in contrast, will attempt to convert any non-<a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>tuple</span></code></a> sequence to an integer or boolean array, which results in an error if the sequence contains a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a> value.</p></li> </ul> <h2 id=vectorized-indexing-mode-vindex><span id=python-vindex-indexing></span>Vectorized indexing mode (<code class="code highlight python docutils literal highlight-python"><span class=n>vindex</span></code>)<a class=headerlink href=#vectorized-indexing-mode-vindex title="Permalink to this headline">¶</a></h2> <p>The expression <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=o>.</span><span class=n>vindex</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> is any <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object and <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> is a valid <a class="reference internal" href=#python-numpy-style-indexing><span class="std std-ref">NumPy-style indexing expression</span></a>, has a similar effect to <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code> except that if <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> specifies any array indexing terms, the broadcasted array dimensions are unconditionally added as the first dimensions of the result domain:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>vindex</span><span class=p>[:,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[4, 8], [2, 6]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>This avoids the potentially-confusing behavior of the default legacy NumPy semantics, under which the broadcasted array dimensions are added inline to the result domain if none of the array indexing terms are separated by a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a>, or <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> term.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> does not include any array indexing terms, <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=o>.</span><span class=n>vindex</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code> is exactly equivalent to <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>.</p> </div> <p>This indexing method is similar to the behavior of:</p> <ul class=simple> <li><p><a class="reference external" href=https://docs.dask.org/en/latest/array-api.html#dask.array.Array.vindex title="(in Dask)"><code class="docutils literal notranslate"><span class=pre>dask.array.Array.vindex</span></code></a>,</p></li> <li><p><a class="reference external" href=https://zarr.readthedocs.io/en/stable/api/core.html#zarr.core.Array title="(in zarr v2.6.1)"><code class="xref any docutils literal notranslate"><span class=pre>zarr.core.Array.vindex</span></code></a>, and</p></li> <li><p>the proposed <code class="code highlight python docutils literal highlight-python"><span class=n>vindex</span></code> in <a class="reference external" href=https://numpy.org/neps/nep-0021-advanced-indexing.html>NumPy Enhancement Proposal 21</a>.</p></li> </ul> <h2 id=outer-indexing-mode-oindex><span id=python-oindex-indexing></span>Outer indexing mode (<code class="code highlight python docutils literal highlight-python"><span class=n>oindex</span></code>)<a class=headerlink href=#outer-indexing-mode-oindex title="Permalink to this headline">¶</a></h2> <p>The expression <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=o>.</span><span class=n>oindex</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> is any <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object and <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> is a valid <a class="reference internal" href=#python-numpy-style-indexing><span class="std std-ref">NumPy-style indexing expression</span></a>, performs <em>outer</em>/<em>orthogonal</em> indexing. The effect is similar to <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>, but differs in that any integer or boolean array indexing terms are applied orthogonally:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>oindex</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[1, 2], [1, 2], [4, 5]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># equivalent, using boolean array</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>oindex</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[1, 2], [1, 2], [4, 5]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [3, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <p>Unlike in the <a class="reference internal" href=#python-indexing-integer-array><span class="std std-ref">default</span></a> or the <a class="reference internal" href=#python-vindex-indexing><span class="std std-ref">vindex</span></a> indexing modes, the index array shapes need not be broadcast-compatible; instead, the dimensions of each index array (or the 1-d index array equivalent of a boolean array) are added to the result domain immediately after any dimensions added by the previous indexing terms:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>oindex</span><span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>:,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[[5, 5, 6], [7, 7, 8]], [[1, 1, 2], [3, 3, 4]]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 2, 3],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0, 0],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>Each boolean array indexing term adds a single dimension to the result domain:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=o>.</span><span class=n>oindex</span><span class=p>[[[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>],</span> <span class=p>[</span><span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>]],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[2, 1], [8, 7]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {&#39;input_exclusive_max&#39;: [2, 2], &#39;input_inclusive_min&#39;: [0, 0]},</span>
<span class=go>})</span>
</code></pre></div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If <code class="code highlight python docutils literal highlight-python"><span class=n>expr</span></code> does not include any array indexing terms, <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=o>.</span><span class=n>oindex</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code> is exactly equivalent to <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>expr</span><span class=p>]</span></code>.</p> </div> <p>This indexing method is similar to the behavior of:</p> <ul class=simple> <li><p><a class="reference external" href=https://zarr.readthedocs.io/en/stable/api/core.html#zarr.core.Array title="(in zarr v2.6.1)"><code class="xref any docutils literal notranslate"><span class=pre>zarr.core.Array.oindex</span></code></a>, and</p></li> <li><p>the proposed <code class="code highlight python docutils literal highlight-python"><span class=n>oindex</span></code> in <a class="reference external" href=https://numpy.org/neps/nep-0021-advanced-indexing.html>NumPy Enhancement Proposal 21</a>.</p></li> </ul> <h3 id=dimension-expressions><span id=python-dim-expressions></span>Dimension expressions<a class=headerlink href=#dimension-expressions title="Permalink to this headline">¶</a></h3> <p><em>Dimension expressions</em> provide an alternative indexing mechanism to <a class="reference internal" href=#python-numpy-style-indexing><span class="std std-ref">NumPy-style indexing</span></a> that is more powerful and expressive and supports <a class="reference internal" href=../index_space.html#dimension-labels><span class="std std-ref">dimension labels</span></a> (but can be more verbose):</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>array</span><span class=p>([[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=p>[</span><span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>]]],</span>
<span class=gp>... </span>             <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Label the dimensions &quot;x&quot;, &quot;y&quot;, &quot;z&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[:]</span><span class=o>.</span><span class=n>label</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>,</span> <span class=s2>&quot;z&quot;</span><span class=p>]]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[[0, 1], [2, 3], [4, 5]], [[6, 7], [8, 9], [10, 11]]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 3, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0, 0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Select the x=0 slice</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[0, 1], [2, 3], [4, 5]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [3, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;y&#39;, &#39;z&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Select the y=1, x=0 slice</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;y&quot;</span><span class=p>,</span> <span class=s2>&quot;x&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [2, 3],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;z&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Transpose &quot;x&quot; and &quot;z&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>,</span> <span class=s2>&quot;z&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>transpose</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[[0, 6], [2, 8], [4, 10]], [[1, 7], [3, 9], [5, 11]]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 3, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0, 0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;z&#39;, &#39;y&#39;, &#39;x&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Select the x=d, y=d diagonal, and transpose &quot;d&quot; to end</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>diagonal</span><span class=o>.</span><span class=n>label</span><span class=p>[</span><span class=s2>&quot;d&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>transpose</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[0, 8], [1, 9]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;z&#39;, &#39;d&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Slice z=0, apply outer indexing to &quot;x&quot; and &quot;y&quot;, label as &quot;a&quot;, &quot;b&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;z&quot;</span><span class=p>,</span> <span class=s2>&quot;x&quot;</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>oindex</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span><span class=o>.</span><span class=n>label</span><span class=p>[</span><span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;b&quot;</span><span class=p>]]</span>
<span class=go>TensorStore({</span>
<span class=go>  &#39;array&#39;: [[4, 2], [10, 8]],</span>
<span class=go>  &#39;context&#39;: {&#39;data_copy_concurrency&#39;: {}},</span>
<span class=go>  &#39;driver&#39;: &#39;array&#39;,</span>
<span class=go>  &#39;dtype&#39;: &#39;int32&#39;,</span>
<span class=go>  &#39;transform&#39;: {</span>
<span class=go>    &#39;input_exclusive_max&#39;: [2, 2],</span>
<span class=go>    &#39;input_inclusive_min&#39;: [0, 0],</span>
<span class=go>    &#39;input_labels&#39;: [&#39;a&#39;, &#39;b&#39;],</span>
<span class=go>  },</span>
<span class=go>})</span>
</code></pre></div> </div> <p>The usual syntax for applying a dimension expression is: <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=n>sel</span><span class=p>]</span> <span class=n>op1</span> <span class=o>...</span> <span class=n>opN</span><span class=p>]</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> is any <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object, <code class="code highlight python docutils literal highlight-python"><span class=n>sel</span></code> specifies the initial <a class="reference internal" href=#python-dim-selections><span class="std std-ref">dimension selection</span></a> and <code class="code highlight python docutils literal highlight-python"><span class=n>op1</span> <span class=o>...</span> <span class=n>opN</span></code> specifies a chain of one or more <a class="reference internal" href=#python-dim-expression-construction><span class="std std-ref">operations</span></a> supported by <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a> (the <code class="code highlight python docutils literal highlight-python"><span class=o>...</span></code> in <code class="code highlight python docutils literal highlight-python"><span class=n>op1</span> <span class=o>...</span> <span class=n>opN</span></code> is not a literal Python <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a> (<code class="code highlight python docutils literal highlight-python"><span class=o>...</span></code>), but simply denotes a sequence of operation invocations).</p> <p>The <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a> object itself, constructed using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=n>sel</span><span class=p>]</span> <span class=n>op1</span> <span class=o>...</span> <span class=n>opN</span></code> is simply a lightweight, immutable representation of the sequence of operations and their arguments, and performs only minimal validation upon construction; full validation is deferred until it is actually applied to an <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object, using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=n>sel</span><span class=p>]</span> <span class=n>op1</span> <span class=o>...</span> <span class=n>opN</span><span class=p>]</span></code>.</p> <h2 id=dimension-selections><span id=python-dim-selections></span>Dimension selections<a class=headerlink href=#dimension-selections title="Permalink to this headline">¶</a></h2> <p>A dimension selection is specified using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=n>sel</span><span class=p>]</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>sel</span></code> is one of:</p> <ul class=simple> <li><p>an integer, specifying an existing or new dimension by index (as with built-in sequence types, negative numbers specify a dimension index relative to the end);</p></li> <li><p>a non-empty <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#str title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>str</span></code></a>, specifying an existing dimension by label;</p></li> <li><p>a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> object, <code class="code highlight python docutils literal highlight-python"><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>:</span><span class=n>step</span></code>, where <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, and <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> are either integers or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>, specifying a range of existing or new dimensions by index (as for built-in sequence types, negative numbers specify a dimension index relative to the end);</p></li> <li><p>any sequence (including a <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#tuple title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>tuple</span></code></a>, <a class="reference internal" href=api/tensorstore.KvStore.list.html title="tensorstore.KvStore.list (Python method) — Lists the keys in the key-value store."><code class="xref any py py-meth docutils literal notranslate"><span class=pre>list</span></code></a>, or another <a class="reference internal" href=api/tensorstore.d.html title="tensorstore.d (Python class) — Specifies a dimension selection, for starting a dimension expression."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.d</span></code></a> object) of any of the above.</p></li> </ul> <p>The result is a <a class="reference internal" href=api/tensorstore.d.html title="tensorstore.d (Python class) — Specifies a dimension selection, for starting a dimension expression."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.d</span></code></a> object, which is simply a lightweight, immutable container representing the flattened sequence of <a class="reference external" href=https://docs.python.org/3/library/functions.html#int title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>int</span></code></a>, <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#str title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>str</span></code></a>, or <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> objects:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
<span class=go>d[0,1,2]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s2>&quot;x&quot;</span><span class=p>]</span>
<span class=go>d[0:1,2,&#39;x&#39;]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>]]</span>
<span class=go>d[0,1,2]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]</span>
<span class=go>d[0,1,2,3]</span>
</code></pre></div> </div> <p>A <a class="reference external" href=https://docs.python.org/3/library/stdtypes.html#str title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>str</span></code></a> label always identifies an existing dimension, and is only compatible with operations/terms that expect an existing dimension:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>][</span><span class=mi>2</span><span class=p>:</span><span class=mi>3</span><span class=p>]]</span>
<span class=go>Rank 1 -&gt; 1 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [2, 3) &quot;x&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
</code></pre></div> </div> <p>An integer may identify either an existing or new dimension depending on whether it is used with a <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> term:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `1` refers to existing dimension &quot;y&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>:</span><span class=mi>3</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    1: [2, 3) &quot;y&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[1]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `1` refers to new singleton dimension</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    1: [0*, 1*)</span>
<span class=go>    2: (-inf*, +inf*) &quot;y&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
</code></pre></div> </div> <p>A negative dimension index <code class="code highlight python docutils literal highlight-python"><span class=o>-</span><span class=n>i</span></code> is equivalent to <code class="code highlight python docutils literal highlight-python"><span class=n>n</span> <span class=o>-</span> <span class=n>i</span></code>, where <code class="docutils literal notranslate"><span class=pre>n</span></code> is the <em>sum</em> of the rank of the original domain <em>plus</em> the number of <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> terms:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `-1` is equivalent to 1, refers to existing dimension &quot;y&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>:</span><span class=mi>3</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    1: [2, 3) &quot;y&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[1]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `-1` is equivalent to 2, refers to new singleton dimension</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]]</span>
<span class=go>Rank 3 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    1: (-inf*, +inf*) &quot;y&quot;</span>
<span class=go>    2: [0*, 1*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[1]</span>
</code></pre></div> </div> <p>Likewise, a <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> may identify either existing or new dimensions:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `:2` refers to existing dimensions &quot;x&quot;, &quot;y&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[:</span><span class=mi>2</span><span class=p>][</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span><span class=mi>4</span><span class=p>]]</span>
<span class=go>Rank 3 -&gt; 3 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [1, 2) &quot;x&quot;</span>
<span class=go>    1: [3, 4) &quot;y&quot;</span>
<span class=go>    2: (-inf*, +inf*) &quot;z&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[1]</span>
<span class=go>    out[2] = 0 + 1 * in[2]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `:2` refers to two new singleton dimensions</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[:</span><span class=mi>2</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span> <span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]]</span>
<span class=go>Rank 5 -&gt; 3 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0*, 1*)</span>
<span class=go>    1: [0*, 1*)</span>
<span class=go>    2: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    3: (-inf*, +inf*) &quot;y&quot;</span>
<span class=go>    4: (-inf*, +inf*) &quot;z&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[2]</span>
<span class=go>    out[1] = 0 + 1 * in[3]</span>
<span class=go>    out[2] = 0 + 1 * in[4]</span>
</code></pre></div> </div> <p>If a <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> term is mixed with a term that consumes an existing dimension, any dimension indices specified in the dimension selection (either directly or via <a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> objects) are with respect to an <em>intermediate</em> domain with any new singleton dimensions inserted but no existing dimensions consumed:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># `1` refers to new singleton dimension, `2` refers to &quot;y&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># intermediate domain is: {0: &quot;x&quot;, 1: &quot;&quot;, 2: &quot;y&quot;}</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    1: [0*, 1*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0</span>
</code></pre></div> </div> <h2 id=dimension-expression-construction><span id=python-dim-expression-construction></span>Dimension expression construction<a class=headerlink href=#dimension-expression-construction title="Permalink to this headline">¶</a></h2> <p>A <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a> that applies a given operation to an initial dimension selection <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=n>sel</span><span class=p>]</span></code> is constructed using:</p> <ul class=simple> <li><p>subscript syntax <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code> (for <a class="reference internal" href=#python-dim-expression-numpy-indexing><span class="std std-ref">NumPy-style indexing</span></a>);</p></li> <li><p>attribute syntax <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>diagonal</span></code> for operations that take no arguments; or</p></li> <li><p>attribute subscript syntax <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>label</span><span class=p>[</span><span class=n>arg</span><span class=p>]</span></code>.</p></li> </ul> <p>The same syntax may also be used to chain additional operations onto an existing <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a>:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_rank</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>][</span><span class=mi>1</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span><span class=o>.</span><span class=n>label</span><span class=p>[</span><span class=s1>&#39;z&#39;</span><span class=p>]]</span>
<span class=go>Rank 1 -&gt; 0 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [1, 10) &quot;z&quot;</span>
<span class=go>  Output index maps:</span>
</code></pre></div> </div> <p>When a <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a> <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span></code> is applied to a <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code>, using the syntax <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span><span class=p>[</span><span class=n>dexpr</span><span class=p>]</span></code>, the following steps occur:</p> <ol class="arabic simple"> <li><p>The initial dimension selection specified in <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span></code> is resolved based on the domain of <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> and the first operation of <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span></code>.</p></li> <li><p>The first operation specified in <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span></code> is applied to <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> using the resolved initial dimension selection. This results in a new <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object of the same type as <code class="code highlight python docutils literal highlight-python"><span class=n>obj</span></code> and a new dimension selection consisting of the dimensions retained from the prior dimension selection or added by the operation.</p></li> <li><p>Each subsequent operation, is applied, in order, to the new <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object and new dimension selection produced by each prior operation.</p></li> </ol> <h2 id=numpy-style-dimension-expression-indexing><span id=python-dim-expression-numpy-indexing></span>NumPy-style dimension expression indexing<a class=headerlink href=#numpy-style-dimension-expression-indexing title="Permalink to this headline">¶</a></h2> <p>The syntax <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>vindex</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code>, and <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>oindex</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code> chains a NumPy-style indexing operation to an existing <a class="reference internal" href=api/tensorstore.d.html title="tensorstore.d (Python class) — Specifies a dimension selection, for starting a dimension expression."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.d</span></code></a> or <a class="reference internal" href=api/tensorstore.DimExpression.html title="tensorstore.DimExpression (Python class) — Specifies an advanced indexing operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.DimExpression</span></code></a>.</p> <p>The behavior is similar to that of regular <a class="reference internal" href=#python-numpy-style-indexing><span class="std std-ref">NumPy-style indexing</span></a> applied directly to a <a class="reference internal" href=api/tensorstore.Indexable.html title="tensorstore.Indexable (Python class) — Abstract base class for types that support TensorStore indexing operations."><code class="xref any py py-class docutils literal notranslate"><span class=pre>tensorstore.Indexable</span></code></a> object, with the following differences:</p> <ul> <li><p>The terms of the indexing expression <code class="code highlight python docutils literal highlight-python"><span class=n>iexpr</span></code> consume dimensions in order from the dimension selection rather than starting from the first dimension of the domain, and unless an <a class="reference external" href=https://docs.python.org/3/library/constants.html#Ellipsis title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>Ellipsis</span></code></a> (<code class="code highlight python docutils literal highlight-python"><span class=o>...</span></code>) term is specified, <code class="code highlight python docutils literal highlight-python"><span class=n>iexpr</span></code> must include a sufficient number of indexing terms to consume the entire dimension selection.</p></li> <li><p><a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> terms are only permitted in the first operation of a dimension expression, since in subsequent operations all dimensions of the dimension selection necessarily refer to existing dimensions. Additionally, the dimension selection must specify the index of the new dimension for each <a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> term.</p></li> <li><p>If <code class="code highlight python docutils literal highlight-python"><span class=n>iexpr</span></code> is a <em>scalar</em> indexing expression that consists of a:</p> <ul class=simple> <li><p>single integer,</p></li> <li><p><a class="reference external" href=https://docs.python.org/3/library/functions.html#slice title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>slice</span></code></a> <code class="code highlight python docutils literal highlight-python"><span class=n>start</span><span class=p>:</span><span class=n>stop</span><span class=p>:</span><span class=n>step</span></code> where <code class="code highlight python docutils literal highlight-python"><span class=n>start</span></code>, <code class="code highlight python docutils literal highlight-python"><span class=n>stop</span></code>, and <code class="code highlight python docutils literal highlight-python"><span class=n>step</span></code> are integers or <a class="reference external" href=https://docs.python.org/3/library/constants.html#None title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class=pre>None</span></code></a>, or</p></li> <li><p><a class="reference internal" href=api/tensorstore.newaxis.html title="tensorstore.newaxis (Python data) — Alias for None used in indexing expressions to specify a new singleton dimension."><code class="xref any py py-data docutils literal notranslate"><span class=pre>tensorstore.newaxis</span></code></a> term,</p></li> </ul> <p>it may be used with a dimension selection of more than one dimension, in which case <code class="code highlight python docutils literal highlight-python"><span class=n>iexpr</span></code> is implicitly duplicated to match the number of dimensions in the dimension selection:</p> <div class="highlight-pycon3 notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>IndexTransform</span><span class=p>(</span><span class=n>input_labels</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;x&quot;</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># add singleton dimension to beginning and end</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>ts</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]]</span>
<span class=go>Rank 4 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0*, 1*)</span>
<span class=go>    1: (-inf*, +inf*) &quot;x&quot;</span>
<span class=go>    2: (-inf*, +inf*) &quot;y&quot;</span>
<span class=go>    3: [0*, 1*)</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[1]</span>
<span class=go>    out[1] = 0 + 1 * in[2]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># slice out square region</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span><span class=p>[</span><span class=n>ts</span><span class=o>.</span><span class=n>d</span><span class=p>[:][</span><span class=mi>0</span><span class=p>:</span><span class=mi>10</span><span class=p>]]</span>
<span class=go>Rank 2 -&gt; 2 index space transform:</span>
<span class=go>  Input domain:</span>
<span class=go>    0: [0, 10) &quot;x&quot;</span>
<span class=go>    1: [0, 10) &quot;y&quot;</span>
<span class=go>  Output index maps:</span>
<span class=go>    out[0] = 0 + 1 * in[0]</span>
<span class=go>    out[1] = 0 + 1 * in[1]</span>
</code></pre></div> </div> </li> <li><p>When using the default indexing mode, i.e. <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code>, if more than one array indexing term is specified (even if they are consecutive), the array dimensions are always added as the first dimensions of the result domain (as if <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>vindex</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code> were specified).</p></li> <li><p>When using outer indexing mode, i.e. <code class="code highlight python docutils literal highlight-python"><span class=n>dexpr</span><span class=o>.</span><span class=n>oindex</span><span class=p>[</span><span class=n>iexpr</span><span class=p>]</span></code>, zero-rank boolean arrays are not permitted.</p></li> </ul> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-up width=24 height=24 viewbox="0 0 24 24"><path d=M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z /></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=tutorial.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Tutorial" rel=prev> <div class="md-footer__button md-icon"> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-left width=24 height=24 viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Tutorial </div> </div> </a> <a href=api/index.html class="md-footer__link md-footer__link--next" aria-label="Next: API reference" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> API reference </div> </div> <div class="md-footer__button md-icon"> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-right width=24 height=24 viewbox="0 0 24 24"><path d=M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z /></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.expand", "navigation.sections", "navigation.top"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../_static/javascripts/bundle.js></script> <script data-url_root=../ id=documentation_options src=../_static/documentation_options.js></script> <script async=async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script>window.MathJax = {"chtml": {"displayAlign": "left"}}</script> </body> </html>