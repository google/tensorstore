<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../../_static/logo.svg><title>tensorstore.TensorStore.write - TensorStore</title><link rel=stylesheet href=../../_static/stylesheets/main.css><link rel=stylesheet href=../../_static/stylesheets/palette.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>
          :root {
            --md-text-font-family: "Roboto";
            --md-code-font-family: "Roboto Mono";
          }
        </style></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=green data-md-color-accent=light-blue> <script>

  /* Prepend the base path to the given key to ensure uniqueness */
  function __prefix(key) {
    var prefix = new URL("../..", location)
    return prefix.pathname + "." + key
  }

  /* Fetch the given key from the given storage */
  function __get(key, storage = localStorage) {
    return JSON.parse(storage.getItem(__prefix(key)))
  }
</script> <script>
  var palette = __get("__palette")
  if (palette !== null && typeof palette.color === "object")
    for (var key in palette.color)
      document.body.setAttribute("data-md-color-" + key, palette.color[key])
</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../index.html title=TensorStore class="md-header__button md-logo" aria-label=TensorStore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 132.0 132.0"><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=2.0 x2=130.8 y2=2.0 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=16.2 x2=130.8 y2=16.2 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=30.4 x2=130.8 y2=30.4 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=44.7 x2=130.8 y2=44.7 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=58.9 x2=130.8 y2=58.9 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=73.1 x2=130.8 y2=73.1 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=87.3 x2=130.8 y2=87.3 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=101.6 x2=130.8 y2=101.6 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=115.8 x2=130.8 y2=115.8 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=130.0 x2=130.8 y2=130.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=2.0 y2=130.0 x2=2.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=16.2 y2=130.0 x2=16.2 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=30.4 y2=130.0 x2=30.4 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=44.7 y2=130.0 x2=44.7 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=58.9 y2=130.0 x2=58.9 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=73.1 y2=130.0 x2=73.1 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=87.3 y2=130.0 x2=87.3 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=101.6 y2=130.0 x2=101.6 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=115.8 y2=130.0 x2=115.8 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=130.0 y2=130.0 x2=130.0 /><rect fill=currentColor x=3.5 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=17.7 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=46.2 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=17.7 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=117.3 width=11.2 height=11.2 /></svg> </a> <label class="md-header__button md-icon" for=__drawer> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-menu width=24 height=24 viewbox="0 0 24 24"><path d=M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z /></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> TensorStore </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> tensorstore.TensorStore.write </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=green data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-lightbulb width=24 height=24 viewbox="0 0 24 24"><path d="M12,2A7,7 0 0,0 5,9C5,11.38 6.19,13.47 8,14.74V17A1,1 0 0,0 9,18H15A1,1 0 0,0 16,17V14.74C17.81,13.47 19,11.38 19,9A7,7 0 0,0 12,2M9,21A1,1 0 0,0 10,22H14A1,1 0 0,0 15,21V20H9V21Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-lightbulb-outline width=24 height=24 viewbox="0 0 24 24"><path d="M12,2A7,7 0 0,1 19,9C19,11.38 17.81,13.47 16,14.74V17A1,1 0 0,1 15,18H9A1,1 0 0,1 8,17V14.74C6.19,13.47 5,11.38 5,9A7,7 0 0,1 12,2M9,21V20H15V21A1,1 0 0,1 14,22H10A1,1 0 0,1 9,21M12,4A5,5 0 0,0 7,9C7,11.05 8.23,12.81 10,13.58V16H14V13.58C15.77,12.81 17,11.05 17,9A5,5 0 0,0 12,4Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-magnify width=24 height=24 viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-magnify width=24 height=24 viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-left width=24 height=24 viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-close width=24 height=24 viewbox="0 0 24 24"><path d=M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z /></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/google/tensorstore/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> google/tensorstore </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=TensorStore class="md-nav__button md-logo" aria-label=TensorStore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 132.0 132.0"><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=2.0 x2=130.8 y2=2.0 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=16.2 x2=130.8 y2=16.2 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=30.4 x2=130.8 y2=30.4 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=44.7 x2=130.8 y2=44.7 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=58.9 x2=130.8 y2=58.9 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=73.1 x2=130.8 y2=73.1 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=87.3 x2=130.8 y2=87.3 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=101.6 x2=130.8 y2=101.6 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=115.8 x2=130.8 y2=115.8 /><line stroke=currentColor stroke-width=1.5 x1=1.25 y1=130.0 x2=130.8 y2=130.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=2.0 y2=130.0 x2=2.0 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=16.2 y2=130.0 x2=16.2 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=30.4 y2=130.0 x2=30.4 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=44.7 y2=130.0 x2=44.7 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=58.9 y2=130.0 x2=58.9 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=73.1 y2=130.0 x2=73.1 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=87.3 y2=130.0 x2=87.3 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=101.6 y2=130.0 x2=101.6 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=115.8 y2=130.0 x2=115.8 /><line stroke=currentColor stroke-width=1.5 y1=2 x1=130.0 y2=130.0 x2=130.0 /><rect fill=currentColor x=3.5 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=17.7 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=46.2 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=3.5 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=17.7 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=31.9 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=46.2 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=60.4 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=74.6 width=11.2 height=11.2 /><rect fill=currentColor x=31.9 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=88.8 width=11.2 height=11.2 /><rect fill=currentColor x=60.4 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=117.3 y=103.1 width=11.2 height=11.2 /><rect fill=currentColor x=74.6 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=88.8 y=117.3 width=11.2 height=11.2 /><rect fill=currentColor x=103.1 y=117.3 width=11.2 height=11.2 /></svg> </a> TensorStore </label> <div class=md-nav__source> <a href=https://github.com/google/tensorstore/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> google/tensorstore </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1> <a class href=../tutorial.html>Python API</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Python API" data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Python API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorial.html class=md-nav__link> Tutorial </a> </li> <li class=md-nav__item> <a href=../indexing.html class=md-nav__link> Indexing </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_3 type=checkbox id=__nav_1_3 checked> <label class=md-nav__link for=__nav_1_3> <a class href=index.html>API reference</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="API reference" data-md-level=2> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> API reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_3_1 type=checkbox id=__nav_1_3_1 checked> <label class=md-nav__link for=__nav_1_3_1> <a class href=index.html#core>Core</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Core data-md-level=3> <label class=md-nav__title for=__nav_1_3_1> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=tensorstore.Context.html class=md-nav__link> <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tensorstore.Context (Python class) — Manages shared TensorStore context resources, such as caches and credentials.">Context</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.Transaction.html class=md-nav__link> <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tensorstore.Transaction (Python class) — Transactions are used to stage a group of modifications (e.g. writes to
tensorstore.TensorStore objects) in memory, and then either commit the
group all at once or abort it.">Transaction</span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_3_1_3 type=checkbox id=__nav_1_3_1_3 checked> <label class=md-nav__link for=__nav_1_3_1_3> <a class href=tensorstore.TensorStore.html><span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle.">TensorStore</span></a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=TensorStore data-md-level=4> <label class=md-nav__title for=__nav_1_3_1_3> <span class="md-nav__icon md-icon"></span> <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle.">TensorStore</span> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=tensorstore.TensorStore.html#accessors class=md-nav__link> Accessors </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.html#data-type class=md-nav__link> Data type </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_3_1_3_3 type=checkbox id=__nav_1_3_1_3_3 checked> <label class=md-nav__link for=__nav_1_3_1_3_3> <a class href=tensorstore.TensorStore.html#i-o>I/O</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=I/O data-md-level=5> <label class=md-nav__title for=__nav_1_3_1_3_3> <span class="md-nav__icon md-icon"></span> I/O </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=tensorstore.TensorStore.read.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.read (Python method) — Reads the data within the current domain.">read</span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.write (Python method) — Writes to the current domain.">write</span> <span class="md-nav__icon md-icon"></span> </label> <a href class="md-nav__link md-nav__link--active"> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.write (Python method) — Writes to the current domain.">write</span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.write (Python method) — Writes to the current domain.">write</span> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#parameters class=md-nav__link> Parameters </a> <nav class=md-nav aria-label=Parameters> <ul class=md-nav__list> <li class=md-nav__item> <a href=#p-source class=md-nav__link> <span aria-label="Python parameter" class="objinfo-icon objinfo-icon__sub-data" title="Python parameter">p</span><span title="tensorstore.TensorStore.write.source (Python parameter) — Source array, broadcast-compatible with
self.domain and with a data type convertible to
self.dtype.">source</span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#returns class=md-nav__link> Returns </a> </li> <li class=md-nav__item> <a href=#non-transactional-semantics class=md-nav__link> Non-transactional semantics </a> </li> <li class=md-nav__item> <a href=#transactional-semantics class=md-nav__link> Transactional semantics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.__array__.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.__array__ (Python method) — Automatic conversion to numpy.ndarray for interoperability with NumPy.">__array__</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.resolve.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.resolve (Python method) — Obtains updated bounds, subject to the cache policy.">resolve</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.__setitem__-transform.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.__setitem__(transform) (Python method) — Synchronously writes using an explicit index transform.">__setitem__(transform)</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.__setitem__-domain.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.__setitem__(domain) (Python method) — Synchronously writes using an explicit index domain.">__setitem__(domain)</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.__setitem__-expr.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.__setitem__(expr) (Python method) — Synchronously writes using a dimension expression.">__setitem__(expr)</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.__setitem__-indices.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.__setitem__(indices) (Python method) — Synchronously writes using NumPy-style indexing with default index array semantics.">__setitem__(indices)</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.oindex.__setitem__.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.oindex.__setitem__ (Python method) — Synchronously writes using NumPy-style indexing with outer indexing semantics.">oindex.__setitem__</span> </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.vindex.__setitem__.html class=md-nav__link> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.vindex.__setitem__ (Python method) — Synchronously writes using NumPy-style indexing with vectorized indexing semantics.">vindex.__setitem__</span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.html#public-members class=md-nav__link> Public members </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.html#transactions class=md-nav__link> Transactions </a> </li> <li class=md-nav__item> <a href=tensorstore.TensorStore.html#indexing class=md-nav__link> Indexing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=tensorstore.open.html class=md-nav__link> <span aria-label="Python function" class="objinfo-icon objinfo-icon__procedure" title="Python function">F</span><span title="tensorstore.open (Python function) — Opens or creates a TensorStore from a Spec.">open</span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=index.html#indexing class=md-nav__link> Indexing </a> </li> <li class=md-nav__item> <a href=index.html#spec class=md-nav__link> Spec </a> </li> <li class=md-nav__item> <a href=index.html#views class=md-nav__link> Views </a> </li> <li class=md-nav__item> <a href=index.html#data-types class=md-nav__link> Data types </a> </li> <li class=md-nav__item> <a href=index.html#asynchronous-support class=md-nav__link> Asynchronous support </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 data-md-state=indeterminate type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> <a class href=../../installation.html>Setup</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Setup data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../installation.html class=md-nav__link> Building and Installing </a> </li> <li class=md-nav__item> <a href=../../environment.html class=md-nav__link> Environment variables </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 data-md-state=indeterminate type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> <a class href=../../spec.html>JSON</a> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=JSON data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> JSON </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../spec.html class=md-nav__link> JSON Spec </a> </li> <li class=md-nav__item> <a href=../../index_space.html class=md-nav__link> Index space </a> </li> <li class=md-nav__item> <a href=../../schema.html class=md-nav__link> Schema </a> </li> <li class=md-nav__item> <a href=../../context.html class=md-nav__link> Context framework </a> </li> <li class=md-nav__item> <a href=../../driver/index.html class=md-nav__link> Drivers </a> </li> <li class=md-nav__item> <a href=../../kvstore/index.html class=md-nav__link> Key-Value Storage Layer </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tensorstore.TensorStore.write (Python method) — Writes to the current domain.">write</span> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#parameters class=md-nav__link> Parameters </a> <nav class=md-nav aria-label=Parameters> <ul class=md-nav__list> <li class=md-nav__item> <a href=#p-source class=md-nav__link> <span aria-label="Python parameter" class="objinfo-icon objinfo-icon__sub-data" title="Python parameter">p</span><span title="tensorstore.TensorStore.write.source (Python parameter) — Source array, broadcast-compatible with
self.domain and with a data type convertible to
self.dtype.">source</span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#returns class=md-nav__link> Returns </a> </li> <li class=md-nav__item> <a href=#non-transactional-semantics class=md-nav__link> Non-transactional semantics </a> </li> <li class=md-nav__item> <a href=#transactional-semantics class=md-nav__link> Transactional semantics </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset" role=main> <dl class="py method objdesc"> <dt class="sig sig-object py sig-wrap"> <em class=property> </em><span class="sig-prename descclassname"><span class=pre>tensorstore.</span><span class=pre>TensorStore.</span></span><span class="sig-name descname"><span class=pre>write</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><a class="reference internal" href=#p-source title="tensorstore.TensorStore.write.source (Python parameter) — Source array, broadcast-compatible with self.domain and with a data type convertible to self.dtype."><span class=n><span class=pre>source</span></span></a><span class=p><span class=pre>:</span></span> <span class=n><span class=desctype><a class="reference internal" href=tensorstore.TensorStore.html title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle."><span class=pre>TensorStore</span></a> <span class=p><span class=pre>|</span></span> <a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><span class=pre>array_like</span></a></span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>&#x2192;</span> <span class=sig-return-typehint><span class=desctype><a class="reference internal" href=tensorstore.WriteFutures.html title="tensorstore.WriteFutures (Python class) — Handle for consuming the result of an asynchronous write operation."><span class=pre>WriteFutures</span></a></span></span></span></dt> <dd><p>Writes to the current domain.</p> <div class="example admonition"> <p class=admonition-title>Example</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>dataset</span> <span class=o>=</span> <span class=k>await</span> <span class=n>ts</span><span class=o>.</span><span class=n>open</span><span class=p>(</span>
<span class=gp>... </span>    <span class=p>{</span>
<span class=gp>... </span>        <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;zarr&#39;</span><span class=p>,</span>
<span class=gp>... </span>        <span class=s1>&#39;kvstore&#39;</span><span class=p>:</span> <span class=p>{</span>
<span class=gp>... </span>            <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;memory&#39;</span>
<span class=gp>... </span>        <span class=p>}</span>
<span class=gp>... </span>    <span class=p>},</span>
<span class=gp>... </span>    <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>uint32</span><span class=p>,</span>
<span class=gp>... </span>    <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>70</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
<span class=gp>... </span>    <span class=n>create</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=go>array([[ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0, 42, 42,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0, 42, 42,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0, 42, 42,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0, 42, 42,  0,  0],</span>
<span class=go>       [ 0,  0,  0,  0,  0,  0, 42, 42,  0,  0]], dtype=uint32)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>write</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=go>array([[1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2]], dtype=uint32)</span>
</code></pre></div> </div> </div> <dl class="field-list simple"> <dt class=field-odd id=parameters>Parameters<a class=headerlink href=#parameters title="Permalink to this headline">¶</a></dt> <dd class=field-odd><dl class="api-field simple"> <dt id=p-source><span class="sig-name descname">source</span><span class=p> : </span><span class=desctype><span class=desctype><a class="reference internal" href=tensorstore.TensorStore.html title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle.">TensorStore</a> <span class=p>|</span> <a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)">array_like</a></span></span><a class=headerlink href=#p-source title="Permalink to this definition">¶</a></dt><dd><p>Source array, <a class="reference internal" href=../../index_space.html#index-domain-alignment><span class="std std-ref">broadcast-compatible</span></a> with <code class="code highlight python docutils literal highlight-python"><span class=bp>self</span><span class=o>.</span><span class=n>domain</span></code> and with a data type convertible to <code class="code highlight python docutils literal highlight-python"><span class=bp>self</span><span class=o>.</span><span class=n>dtype</span></code>. May be an existing <a class="reference internal" href=tensorstore.TensorStore.html title="tensorstore.TensorStore (Python class) — Asynchronous multi-dimensional array handle."><code class="xref py py-obj docutils literal notranslate"><span class=pre>TensorStore</span></code></a> or any <a class="reference external" href=https://numpy.org/doc/stable/glossary.html#term-array-like title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class=pre>array_like</span></code></a>, including a scalar.</p> </dd> </dl> </dd> <dt class=field-even id=returns>Returns<a class=headerlink href=#returns title="Permalink to this headline">¶</a></dt> <dd class=field-even><p>Future representing the asynchronous result of the write operation.</p> </dd> </dl> <p>Logically there are two steps to the write operation:</p> <ol class="arabic simple"> <li><p>reading/copying from the <code class="code highlight python docutils literal highlight-python"><span class=n>source</span></code>, and</p></li> <li><p>waiting for the write to be committed, such that it will be reflected in subsequent reads.</p></li> </ol> <p>The completion of these two steps can be tracked separately using the returned <a class="reference internal" href=tensorstore.WriteFutures.copy.html title="tensorstore.WriteFutures.copy (Python property)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>WriteFutures.copy</span></code></a> and <a class="reference internal" href=tensorstore.WriteFutures.commit.html title="tensorstore.WriteFutures.commit (Python property)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>WriteFutures.commit</span></code></a> futures, respectively:</p> <p>Waiting on the returned <a class="reference internal" href=tensorstore.WriteFutures.html title="tensorstore.WriteFutures (Python class) — Handle for consuming the result of an asynchronous write operation."><code class="xref any py py-class docutils literal notranslate"><span class=pre>WriteFutures</span></code></a> object itself waits for the entire write operation to complete, and is equivalent to waiting on the <a class="reference internal" href=tensorstore.WriteFutures.commit.html title="tensorstore.WriteFutures.commit (Python property)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>WriteFutures.commit</span></code></a> future. The returned <a class="reference internal" href=tensorstore.WriteFutures.copy.html title="tensorstore.WriteFutures.copy (Python property)"><code class="xref py py-obj docutils literal notranslate"><span class=pre>WriteFutures.copy</span></code></a> future becomes ready once the data has been fully read from <code class="code highlight python docutils literal highlight-python"><span class=n>source</span></code>. After this point, <code class="code highlight python docutils literal highlight-python"><span class=n>source</span></code> may be safely modified without affecting the write operation.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>You must either synchronously or asynchronously wait on the returned future in order to ensure the write actually completes. If all references to the future are dropped without waiting on it, the write may be cancelled.</p> </div> <h2 id=non-transactional-semantics>Non-transactional semantics<a class=headerlink href=#non-transactional-semantics title="Permalink to this headline">¶</a></h2> <p>When <em>not</em> using a <a class="reference internal" href=tensorstore.Transaction.html title="tensorstore.Transaction (Python class) — Transactions are used to stage a group of modifications (e.g. writes to tensorstore.TensorStore objects) in memory, and then either commit the group all at once or abort it."><code class="xref py py-obj docutils literal notranslate"><span class=pre>Transaction</span></code></a>, the returned <a class="reference internal" href=tensorstore.WriteFutures.commit.html title="tensorstore.WriteFutures.commit (Python property)"><code class="xref any py py-attr docutils literal notranslate"><span class=pre>WriteFutures.commit</span></code></a> future becomes ready only once the data has been durably committed by the underlying storage layer. The precise durability guarantees depend on the driver, but for example:</p> <ul class=simple> <li><p>when using the <a class="reference internal" href=../../kvstore/file/index.html#file-kvstore-driver><span class="std std-ref">file Key-Value Store driver</span></a>, the data is only considered committed once the <code class="docutils literal notranslate"><span class=pre>fsync</span></code> system call completes, which should normally guarantee that it will survive a system crash;</p></li> <li><p>when using the <a class="reference internal" href=../../kvstore/gcs/index.html#gcs-kvstore-driver><span class="std std-ref">gcs Key-Value Store driver</span></a>, the data is only considered committed once the write is acknowledged and durability is guaranteed by Google Cloud Storage.</p></li> </ul> <p>Because committing a write often has significant latency, it is advantageous to issue multiple writes concurrently and then wait on all of them jointly:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>dataset</span> <span class=o>=</span> <span class=k>await</span> <span class=n>ts</span><span class=o>.</span><span class=n>open</span><span class=p>(</span>
<span class=gp>... </span>    <span class=p>{</span>
<span class=gp>... </span>        <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;zarr&#39;</span><span class=p>,</span>
<span class=gp>... </span>        <span class=s1>&#39;kvstore&#39;</span><span class=p>:</span> <span class=p>{</span>
<span class=gp>... </span>            <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;memory&#39;</span>
<span class=gp>... </span>        <span class=p>}</span>
<span class=gp>... </span>    <span class=p>},</span>
<span class=gp>... </span>    <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>uint32</span><span class=p>,</span>
<span class=gp>... </span>    <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>70</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
<span class=gp>... </span>    <span class=n>create</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>wait</span><span class=p>([</span><span class=n>dataset</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>5</span><span class=p>]</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)])</span>
</code></pre></div> </div> <p>This can also be accomplished with synchronous blocking:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>dataset</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>open</span><span class=p>({</span>
<span class=gp>... </span>    <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;zarr&#39;</span><span class=p>,</span>
<span class=gp>... </span>    <span class=s1>&#39;kvstore&#39;</span><span class=p>:</span> <span class=p>{</span>
<span class=gp>... </span>        <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;memory&#39;</span>
<span class=gp>... </span>    <span class=p>}</span>
<span class=gp>... </span><span class=p>},</span>
<span class=gp>... </span>                  <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>uint32</span><span class=p>,</span>
<span class=gp>... </span>                  <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>70</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
<span class=gp>... </span>                  <span class=n>create</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>futures</span> <span class=o>=</span> <span class=p>[</span><span class=n>dataset</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>5</span><span class=p>]</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>futures</span><span class=p>:</span>
<span class=gp>... </span>    <span class=n>f</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</code></pre></div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>When issuing writes asynchronously, keep in mind that uncommitted writes are never reflected in non-transactional reads.</p> </div> <p>For most drivers, data is written in fixed-size <a class="reference internal" href=../../schema.html#chunk-layout><span class="std std-ref">write chunks</span></a> arranged in a regular grid. When concurrently issuing multiple writes that are not perfectly aligned to disjoint write chunks, specifying a <a class="reference internal" href=../../context.html#json-Context.cache_pool title="Context.cache_pool (JSON type)"><code class="xref json json-schema docutils literal notranslate"><span class=pre>Context.cache_pool</span></code></a> enables writeback caching, which can improve efficiency by coalescing multiple writes to the same chunk.</p> <p>Alternatively, for more explicit control over writeback behavior, you can use a <a class="reference internal" href=tensorstore.Transaction.html title="tensorstore.Transaction (Python class) — Transactions are used to stage a group of modifications (e.g. writes to tensorstore.TensorStore objects) in memory, and then either commit the group all at once or abort it."><code class="xref py py-obj docutils literal notranslate"><span class=pre>Transaction</span></code></a>.</p> <h2 id=transactional-semantics>Transactional semantics<a class=headerlink href=#transactional-semantics title="Permalink to this headline">¶</a></h2> <p>Transactions provide explicit control over writeback, and allow uncommitted writes to be read:</p> <div class="doctest highlight-default notranslate"><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>txn</span> <span class=o>=</span> <span class=n>ts</span><span class=o>.</span><span class=n>Transaction</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>dataset</span> <span class=o>=</span> <span class=k>await</span> <span class=n>ts</span><span class=o>.</span><span class=n>open</span><span class=p>(</span>
<span class=gp>... </span>    <span class=p>{</span>
<span class=gp>... </span>        <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;zarr&#39;</span><span class=p>,</span>
<span class=gp>... </span>        <span class=s1>&#39;kvstore&#39;</span><span class=p>:</span> <span class=p>{</span>
<span class=gp>... </span>            <span class=s1>&#39;driver&#39;</span><span class=p>:</span> <span class=s1>&#39;memory&#39;</span>
<span class=gp>... </span>        <span class=p>}</span>
<span class=gp>... </span>    <span class=p>},</span>
<span class=gp>... </span>    <span class=n>dtype</span><span class=o>=</span><span class=n>ts</span><span class=o>.</span><span class=n>uint32</span><span class=p>,</span>
<span class=gp>... </span>    <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>70</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
<span class=gp>... </span>    <span class=n>create</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=o>.</span><span class=n>with_transaction</span><span class=p>(</span><span class=n>txn</span><span class=p>)[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>write</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Transactional read reflects uncommitted write</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=o>.</span><span class=n>with_transaction</span><span class=p>(</span><span class=n>txn</span><span class=p>)[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=go>array([[1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2]], dtype=uint32)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Non-transactional read does not reflect uncommitted write</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=go>array([[0, 0],</span>
<span class=go>       [0, 0],</span>
<span class=go>       [0, 0],</span>
<span class=go>       [0, 0],</span>
<span class=go>       [0, 0]], dtype=uint32)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>txn</span><span class=o>.</span><span class=n>commit_async</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=c1># Now, non-transactional read reflects committed write</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>await</span> <span class=n>dataset</span><span class=p>[</span><span class=mi>5</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=go>array([[1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2],</span>
<span class=go>       [1, 2]], dtype=uint32)</span>
</code></pre></div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>When using a <a class="reference internal" href=tensorstore.Transaction.html title="tensorstore.Transaction (Python class) — Transactions are used to stage a group of modifications (e.g. writes to tensorstore.TensorStore objects) in memory, and then either commit the group all at once or abort it."><code class="xref py py-obj docutils literal notranslate"><span class=pre>Transaction</span></code></a>, the returned <a class="reference internal" href=tensorstore.WriteFutures.commit.html title="tensorstore.WriteFutures.commit (Python property)"><code class="xref any py py-attr docutils literal notranslate"><span class=pre>WriteFutures.commit</span></code></a> future does <em>not</em> indicate that the data is durably committed by the underlying storage layer. Instead, it merely indicates that the write will be reflected in any subsequent reads <em>using the same transaction</em>. The write is only durably committed once the <em>transaction</em> is committed successfully.</p> </div> </dd></dl> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-up width=24 height=24 viewbox="0 0 24 24"><path d=M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z /></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=tensorstore.TensorStore.read.html class="md-footer__link md-footer__link--prev" aria-label="Previous: tensorstore.TensorStore.read" rel=prev> <div class="md-footer__button md-icon"> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-left width=24 height=24 viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> tensorstore.TensorStore.read </div> </div> </a> <a href=tensorstore.TensorStore.__array__.html class="md-footer__link md-footer__link--next" aria-label="Next: tensorstore.TensorStore.__array__" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> tensorstore.TensorStore.__array__ </div> </div> <div class="md-footer__button md-icon"> <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=mdi-arrow-right width=24 height=24 viewbox="0 0 24 24"><path d=M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z /></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.expand", "navigation.sections", "navigation.top"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../_static/javascripts/bundle.js></script> <script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script> </body> </html>